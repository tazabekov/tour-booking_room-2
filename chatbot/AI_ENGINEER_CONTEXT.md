# AI Engineer Context: Tour Booking Chatbot

> **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞**: –≠—Ç–æ—Ç —Ñ–∞–π–ª —Å–ª—É–∂–∏—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º –¥–ª—è AI –∞–≥–µ–Ω—Ç–æ–≤, —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö —Å —á–∞—Ç-–±–æ—Ç–æ–º —Ç—É—Ä–∏—Å—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞–≥–µ–Ω—Ç—Å—Ç–≤–∞. –°–æ–¥–µ—Ä–∂–∏—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É, –ø—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞–±–æ—Ç—ã –∏ –∫–ª—é—á–µ–≤—ã–µ –¥–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏.

---

## üìã –û–±–∑–æ—Ä

–ß–∞—Ç-–±–æ—Ç –¥–ª—è —Ç—É—Ä–∏—Å—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞–≥–µ–Ω—Ç—Å—Ç–≤–∞ –Ω–∞ –±–∞–∑–µ **LangChain** –∏ **OpenAI GPT-4**. –ê–≥–µ–Ω—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã (tools) –¥–ª—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–≥–æ –ø–æ–ª—É—á–µ–Ω–∏—è –∞–∫—Ç—É–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ –±—ç–∫–µ–Ω–¥ API, –Ω–µ –≥–µ–Ω–µ—Ä–∏—Ä—É—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç—É—Ä–∞—Ö —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ.

### –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã:
- ‚úÖ **–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ tools** - –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –æ —Ç—É—Ä–∞—Ö –ø–æ–ª—É—á–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ API
- ‚úÖ **–ù–µ –≤—ã–¥—É–º—ã–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ** - –∞–≥–µ–Ω—Ç –ù–ï –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç—É—Ä–∞—Ö, —Ü–µ–Ω–∞—Ö –∏–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏
- ‚úÖ **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞** - –ø–∞–º—è—Ç—å —Ä–∞–∑–≥–æ–≤–æ—Ä–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –º–µ–∂–¥—É —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏
- ‚úÖ **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** - –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –±—ç–∫–µ–Ω–¥–∞ —Å –∏–Ω—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    User Input                           ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                       ‚îÇ
                       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ              MainAgent (LangChain)                      ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ  System Prompts (behavior control)               ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  - –ò—Å–ø–æ–ª—å–∑—É–π tools –¥–ª—è –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤             ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  - –ù–µ –≤—ã–¥—É–º—ã–≤–∞–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é                       ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  - –ë—É–¥—å –≤–µ–∂–ª–∏–≤—ã–º –∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–º              ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ  Conversation Memory (per session)               ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  - ConversationBufferMemory                      ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ chat_history                       ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ  Tools Registry                                  ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  - get_tours                                     ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  - get_tour_details                              ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  - create_booking                                ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  - get_booking_details                           ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  - get_user_bookings                             ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                       ‚îÇ
                       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ           Backend Tools (HTTP Client)                   ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ  Requests –∫ Backend API                          ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  - Error handling                                ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  - Response parsing                              ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                       ‚îÇ
                       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ         Backend API (FastAPI)                           ‚îÇ
‚îÇ         http://localhost:8000/api/v1                    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
chatbot/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ agent/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ main_agent.py          # –ì–ª–∞–≤–Ω—ã–π –∞–≥–µ–Ω—Ç (MainAgent class)
‚îÇ   ‚îú‚îÄ‚îÄ prompts/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ system_prompts.py      # –°–∏—Å—Ç–µ–º–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã (SYSTEM_PROMPT)
‚îÇ   ‚îú‚îÄ‚îÄ tools/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ backend_tools.py       # HTTP —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è API (get_tours, etc.)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ tool_registry.py       # –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è tools –¥–ª—è –∞–≥–µ–Ω—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ memory/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ conversation_memory.py # ConversationMemory class
‚îÇ   ‚îî‚îÄ‚îÄ main.py                    # CLI —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ (src/main.py)
‚îú‚îÄ‚îÄ main.py                        # –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îú‚îÄ‚îÄ requirements.txt               # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ .env                          # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (–Ω–µ –≤ git)
‚îú‚îÄ‚îÄ .env.example                  # –ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ README.md                     # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îú‚îÄ‚îÄ PLAN.md                       # –ü–ª–∞–Ω —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
‚îî‚îÄ‚îÄ AI_ENGINEER_CONTEXT.md        # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

---

## üîë –ö–ª—é—á–µ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### 1. MainAgent (`src/agent/main_agent.py`)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ì–ª–∞–≤–Ω—ã–π –∫–ª–∞—Å—Å –∞–≥–µ–Ω—Ç–∞, –∫–æ–æ—Ä–¥–∏–Ω–∏—Ä—É—é—â–∏–π —Ä–∞–±–æ—Ç—É –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤.

**–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã**:
- `ChatOpenAI` - LLM (GPT-4-turbo-preview –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- `AgentExecutor` - –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å –∞–≥–µ–Ω—Ç–∞ —Å tools
- `ConversationMemory` - –º–µ–Ω–µ–¥–∂–µ—Ä –ø–∞–º—è—Ç–∏ —Å–µ—Å—Å–∏–π
- `create_tools()` - —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤

**–ú–µ—Ç–æ–¥—ã**:
- `__init__()` - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∞–≥–µ–Ω—Ç–∞, LLM, tools, –ø–∞–º—è—Ç–∏, –ø—Ä–æ–º–ø—Ç–æ–≤
- `process(query: str, session_id: str) -> Dict[str, Any]` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `clear_session(session_id: str)` - –æ—á–∏—Å—Ç–∫–∞ –ø–∞–º—è—Ç–∏ —Å–µ—Å—Å–∏–∏

**–í–∞–∂–Ω–æ**:
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `create_openai_tools_agent` –¥–ª—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ tools
- –ü—Ä–æ–º–ø—Ç –≤–∫–ª—é—á–∞–µ—Ç `MessagesPlaceholder` –¥–ª—è chat_history –∏ agent_scratchpad
- `handle_parsing_errors=True` –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ –ø–∞—Ä—Å–∏–Ω–≥–∞
- `max_iterations=5` - –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∏—Ç–µ—Ä–∞—Ü–∏–π –∞–≥–µ–Ω—Ç–∞

### 2. System Prompts (`src/prompts/system_prompts.py`)

**SYSTEM_PROMPT** –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø–æ–≤–µ–¥–µ–Ω–∏–µ –∞–≥–µ–Ω—Ç–∞:
- –†–æ–ª—å: AI –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç —Ç—É—Ä–∏—Å—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞–≥–µ–Ω—Ç—Å—Ç–≤–∞
- –ü—Ä–∞–≤–∏–ª–æ: –í–°–ï–ì–î–ê –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å tools –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
- –ó–∞–ø—Ä–µ—Ç: –ù–ï –≤—ã–¥—É–º—ã–≤–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç—É—Ä–∞—Ö
- –ü–æ–≤–µ–¥–µ–Ω–∏–µ: –¥—Ä—É–∂–µ–ª—é–±–Ω—ã–π, –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π, –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ

**–ö–ª—é—á–µ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏**:
- –ü—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ —Ç—É—Ä–æ–≤ ‚Üí –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `get_tours`
- –ü—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ –¥–µ—Ç–∞–ª–µ–π ‚Üí –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `get_tour_details`
- –ü—Ä–∏ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏ ‚Üí —Å–æ–±—Ä–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `create_booking`
- –ü—Ä–∏ –∏—Å—Ç–æ—Ä–∏–∏ ‚Üí –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `get_user_bookings`

### 3. Tools (`src/tools/`)

#### backend_tools.py

HTTP —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –±—ç–∫–µ–Ω–¥ API:

1. **get_tours** - –ø–æ–∏—Å–∫ —Ç—É—Ä–æ–≤ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π
   - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: country, min_price, max_price, start_date, end_date, page, page_size
   - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: `{"success": bool, "data": {...}, "error": str}`

2. **get_tour_details** - –¥–µ—Ç–∞–ª–∏ —Ç—É—Ä–∞ –ø–æ ID
   - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: tour_id (int)
   - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: –ø–æ–ª–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç—É—Ä–µ

3. **create_booking** - —Å–æ–∑–¥–∞–Ω–∏–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
   - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: tour_id, customer_name, customer_email, customer_phone, number_of_people, notes (optional)
   - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–æ–∑–¥–∞–Ω–Ω–æ–º –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏

4. **get_booking_details** - –¥–µ—Ç–∞–ª–∏ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
   - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: booking_id (int)
   - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏

5. **get_user_bookings** - –∏—Å—Ç–æ—Ä–∏—è –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π
   - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: email (str)
   - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: —Å–ø–∏—Å–æ–∫ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**:
- –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç `{"success": bool, ...}`
- –ü—Ä–∏ –æ—à–∏–±–∫–∞—Ö: `{"success": False, "error": str, "message": str}`
- –û–±—Ä–∞–±–æ—Ç–∫–∞ HTTPError (404, 400) –∏ RequestException

#### tool_registry.py

–†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç —Ñ—É–Ω–∫—Ü–∏–∏ –∫–∞–∫ LangChain `StructuredTool` —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º–∏ –æ–ø–∏—Å–∞–Ω–∏—è–º–∏ –¥–ª—è –∞–≥–µ–Ω—Ç–∞:
- `name` - –∏–º—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞
- `description` - –∫–æ–≥–¥–∞ –∏ –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å (–≤–∞–∂–Ω–æ –¥–ª—è –≤—ã–±–æ—Ä–∞ –∞–≥–µ–Ω—Ç–∞)
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑–≤–ª–µ–∫–∞—é—Ç—Å—è –∏–∑ —Å–∏–≥–Ω–∞—Ç—É—Ä —Ñ—É–Ω–∫—Ü–∏–π

### 4. Memory (`src/memory/conversation_memory.py`)

**ConversationMemory** - –º–µ–Ω–µ–¥–∂–µ—Ä –ø–∞–º—è—Ç–∏ –¥–ª—è –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Å–µ—Å—Å–∏–π:
- –•—Ä–∞–Ω–∏—Ç `ConversationBufferMemory` –¥–ª—è –∫–∞–∂–¥–æ–π session_id
- –õ–µ–Ω–∏–≤–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –æ–±—Ä–∞—â–µ–Ω–∏–∏
- –ú–µ—Ç–æ–¥—ã: `get_memory()`, `clear_memory()`, `get_chat_history()`

**–í–∞–∂–Ω–æ**:
- –ü–∞–º—è—Ç—å —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –ø–∞–º—è—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞ (in-memory)
- –ü—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ –±–æ—Ç–∞ –ø–∞–º—è—Ç—å —Ç–µ—Ä—è–µ—Ç—Å—è
- –î–ª—è production –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Redis/PostgreSQL

---

## üîå –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Backend API

### –ë–∞–∑–æ–≤—ã–π URL
```
BACKEND_URL = http://localhost:8000
API_BASE = {BACKEND_URL}/api/v1
```

### Endpoints

| –ú–µ—Ç–æ–¥ | Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ | Tools —Ñ—É–Ω–∫—Ü–∏—è |
|-------|----------|----------|---------------|
| GET | `/api/v1/tours/` | –°–ø–∏—Å–æ–∫ —Ç—É—Ä–æ–≤ (—Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏) | `get_tours()` |
| GET | `/api/v1/tours/{id}` | –î–µ—Ç–∞–ª–∏ —Ç—É—Ä–∞ | `get_tour_details()` |
| POST | `/api/v1/bookings/` | –°–æ–∑–¥–∞—Ç—å –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ | `create_booking()` |
| GET | `/api/v1/bookings/{id}` | –î–µ—Ç–∞–ª–∏ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è | `get_booking_details()` |
| GET | `/api/v1/bookings/?email=...` | –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ email | `get_user_bookings()` |

### Query –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è `/tours/`
- `country` (str) - —Ñ–∏–ª—å—Ç—Ä –ø–æ —Å—Ç—Ä–∞–Ω–µ
- `min_price` (float) - –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞
- `max_price` (float) - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞
- `start_date` (str, ISO) - –¥–∞—Ç–∞ –Ω–∞—á–∞–ª–∞
- `end_date` (str, ISO) - –¥–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è
- `page` (int) - –Ω–æ–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã (default: 1)
- `page_size` (int) - —Ä–∞–∑–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã (default: 10, max: 100)

### –§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è (POST)
```json
{
  "tour_id": 1,
  "customer_name": "–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤",
  "customer_email": "ivan@example.com",
  "customer_phone": "+7 999 123 45 67",
  "number_of_people": 2,
  "notes": "–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π (optional)"
}
```

---

## üöÄ –ó–∞–ø—É—Å–∫ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
```bash
cd chatbot
python3 -m venv venv
source venv/bin/activate  # Linux/Mac
pip install -r requirements.txt
```

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (.env)
```env
OPENAI_API_KEY=your_openai_api_key_here
BACKEND_URL=http://localhost:8000
OPENAI_MODEL=gpt-4-turbo-preview  # –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
AGENT_TEMPERATURE=0.7              # –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
VERBOSE=false                      # –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ (–¥–ª—è –æ—Ç–ª–∞–¥–∫–∏)
```

### –ó–∞–ø—É—Å–∫
```bash
# –ß–µ—Ä–µ–∑ src/main.py
python src/main.py

# –ò–ª–∏ —á–µ—Ä–µ–∑ main.py
python main.py
```

### CLI –∫–æ–º–∞–Ω–¥—ã
- `exit` / `quit` / `–≤—ã—Ö–æ–¥` - –≤—ã—Ö–æ–¥
- `clear` / `–æ—á–∏—Å—Ç–∏—Ç—å` - –æ—á–∏—Å—Ç–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ —Ä–∞–∑–≥–æ–≤–æ—Ä–∞

---

## üîÑ –ü–æ—Ç–æ–∫ —Ä–∞–±–æ—Ç—ã –∞–≥–µ–Ω—Ç–∞

### –ü—Ä–∏–º–µ—Ä: –ü–æ–∏—Å–∫ —Ç—É—Ä–æ–≤

```
1. User: "–ü–æ–∫–∞–∂–∏ —Ç—É—Ä—ã –≤ –¢—É—Ä—Ü–∏–∏"
   ‚îÇ
   ‚ñº
2. MainAgent.process("–ü–æ–∫–∞–∂–∏ —Ç—É—Ä—ã –≤ –¢—É—Ä—Ü–∏–∏", session_id)
   ‚îÇ
   ‚ñº
3. AgentExecutor –ø–æ–ª—É—á–∞–µ—Ç –∑–∞–ø—Ä–æ—Å
   ‚îÇ
   ‚ñº
4. LLM –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å + SYSTEM_PROMPT
   ‚îÇ
   ‚ñº
5. LLM —Ä–µ—à–∞–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å tool: get_tours(country="–¢—É—Ä—Ü–∏—è")
   ‚îÇ
   ‚ñº
6. –í—ã–∑–æ–≤ get_tours() ‚Üí HTTP GET /api/v1/tours/?country=–¢—É—Ä—Ü–∏—è
   ‚îÇ
   ‚ñº
7. Backend –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–ª–∏ –æ—à–∏–±–∫—É
   ‚îÇ
   ‚ñº
8. –†–µ–∑—É–ª—å—Ç–∞—Ç –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è LLM
   ‚îÇ
   ‚ñº
9. LLM —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –æ—Ç–≤–µ—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö (–ù–ï –≤—ã–¥—É–º—ã–≤–∞—è)
   ‚îÇ
   ‚ñº
10. –û—Ç–≤–µ—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ memory + –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
```

### –ü—Ä–∏–º–µ—Ä: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

```
1. User: "–ú–µ–Ω—è –∑–æ–≤—É—Ç –ò–≤–∞–Ω"
   ‚Üí –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ memory

2. User: "–ö–∞–∫ –º–µ–Ω—è –∑–æ–≤—É—Ç?"
   ‚Üí Agent –ø–æ–ª—É—á–∞–µ—Ç chat_history –∏–∑ memory
   ‚Üí LLM –≤–∏–¥–∏—Ç –ø—Ä–µ–¥—ã–¥—É—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
   ‚Üí –û—Ç–≤–µ—á–∞–µ—Ç: "–¢—ã –ø—Ä–µ–¥—Å—Ç–∞–≤–∏–ª—Å—è –∫–∞–∫ –ò–≤–∞–Ω"
```

---

## ‚öôÔ∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (requirements.txt)
```
openai>=1.12.0
langchain>=0.1.0
langchain-openai>=0.0.5
langchain-community>=0.0.20
python-dotenv>=1.0.0
requests>=2.31.0
```

### –ú–æ–¥–µ–ª—å LLM
- –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: `gpt-4-turbo-preview`
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `OPENAI_MODEL` –≤ .env
- Temperature: 0.7 (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `AGENT_TEMPERATURE`)

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
1. **–û—à–∏–±–∫–∏ –±—ç–∫–µ–Ω–¥–∞**: Tools –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç `{"success": False, "message": "..."}`
2. **–û—à–∏–±–∫–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞**: `handle_parsing_errors=True` –≤ AgentExecutor
3. **–û—à–∏–±–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è**: Try-except –≤ `process()` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
4. **–ù–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –±—ç–∫–µ–Ω–¥–∞**: –ê–≥–µ–Ω—Ç —Å–æ–æ–±—â–∞–µ—Ç –æ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π –æ—à–∏–±–∫–µ –∏ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –ø–æ–∑–∂–µ

### Memory —Ñ–æ—Ä–º–∞—Ç
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `ConversationBufferMemory` –∏–∑ LangChain
- –§–æ—Ä–º–∞—Ç: —Å–ø–∏—Å–æ–∫ `BaseMessage` (HumanMessage, AIMessage)
- –ü–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ –ø—Ä–æ–º–ø—Ç —á–µ—Ä–µ–∑ `MessagesPlaceholder(variable_name="chat_history")`

---

## üìù –í–∞–∂–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã –¥–ª—è AI –∞–≥–µ–Ω—Ç–æ–≤

### ‚úÖ –ß—Ç–æ –¥–µ–ª–∞—Ç—å:
1. **–í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å tools** - –∞–≥–µ–Ω—Ç –î–û–õ–ñ–ï–ù –≤—ã–∑—ã–≤–∞—Ç—å tools –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
2. **–ü—Ä–æ–≤–µ—Ä—è—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã** - –ø—Ä–æ–≤–µ—Ä—è—Ç—å `success` –≤ –æ—Ç–≤–µ—Ç–∞—Ö tools
3. **–ò–Ω—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** - –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö –±—ç–∫–µ–Ω–¥–∞ —Å–æ–æ–±—â–∞—Ç—å –ø–æ–Ω—è—Ç–Ω—ã–º —è–∑—ã–∫–æ–º
4. **–°–æ—Ö—Ä–∞–Ω—è—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å session_id –¥–ª—è –∏–∑–æ–ª—è—Ü–∏–∏ —Ä–∞–∑–≥–æ–≤–æ—Ä–æ–≤
5. **–°–ª–µ–¥–æ–≤–∞—Ç—å –ø—Ä–æ–º–ø—Ç–∞–º** - SYSTEM_PROMPT –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø–æ–≤–µ–¥–µ–Ω–∏–µ –∞–≥–µ–Ω—Ç–∞

### ‚ùå –ß–µ–≥–æ –ù–ï –¥–µ–ª–∞—Ç—å:
1. **–ù–µ –≤—ã–¥—É–º—ã–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ** - –Ω–µ –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç—É—Ä–∞—Ö, —Ü–µ–Ω–∞—Ö, –¥–∞—Ç–∞—Ö
2. **–ù–µ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å tools** - –∞–≥–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å tools, –∞ –Ω–µ –æ—Ç–≤–µ—á–∞—Ç—å –∏–∑ –ø–∞–º—è—Ç–∏ LLM
3. **–ù–µ —Ç–µ—Ä—è—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç** - –≤—Å–µ–≥–¥–∞ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å chat_history –≤ AgentExecutor
4. **–ù–µ –∑–∞–±—ã–≤–∞—Ç—å –ø—Ä–æ –æ—à–∏–±–∫–∏** - –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –æ—à–∏–±–∫–∏ –±—ç–∫–µ–Ω–¥–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã –∞–≥–µ–Ω—Ç–∞:
1. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ tools** - –≤ verbose —Ä–µ–∂–∏–º–µ –≤–∏–¥–Ω–æ –≤—ã–∑–æ–≤—ã tools
2. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞** - –∑–∞–ø–æ–º–Ω–∏—Ç—å –∏–º—è, –∑–∞—Ç–µ–º —Å–ø—Ä–æ—Å–∏—Ç—å
3. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** - –∑–∞–ø—Ä–æ—Å –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ–º –±—ç–∫–µ–Ω–¥–µ
4. **–†–∞–∑–ª–∏—á–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã** - –ø–æ–∏—Å–∫, –¥–µ—Ç–∞–ª–∏, –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ, –∏—Å—Ç–æ—Ä–∏—è

### –ü—Ä–∏–º–µ—Ä—ã —Ç–µ—Å—Ç–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤:
- "–ü—Ä–∏–≤–µ—Ç! –ö–∞–∫ –¥–µ–ª–∞?" - –±–∞–∑–æ–≤–æ–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ
- "–ü–æ–∫–∞–∂–∏ –º–Ω–µ –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Ç—É—Ä—ã" - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ get_tours
- "–ö–∞–∫–∏–µ —Ç—É—Ä—ã –µ—Å—Ç—å –≤ –¢—É—Ä—Ü–∏–∏?" - —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Å—Ç—Ä–∞–Ω–µ
- "–ù–∞–π–¥–∏ —Ç—É—Ä—ã –¥–µ—à–µ–≤–ª–µ 100000 —Ä—É–±–ª–µ–π" - —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Ü–µ–Ω–µ
- "–†–∞—Å—Å–∫–∞–∂–∏ –ø–æ–¥—Ä–æ–±–Ω–µ–µ –ø—Ä–æ —Ç—É—Ä —Å ID 1" - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ get_tour_details
- "–ú–µ–Ω—è –∑–æ–≤—É—Ç –ò–≤–∞–Ω" ‚Üí "–ö–∞–∫ –º–µ–Ω—è –∑–æ–≤—É—Ç?" - –ø—Ä–æ–≤–µ—Ä–∫–∞ memory

---

## üîÆ –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

### –í–æ–∑–º–æ–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:
1. **–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–∞—è –ø–∞–º—è—Ç—å** - Redis/PostgreSQL –≤–º–µ—Å—Ç–æ in-memory
2. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ª–æ–≥–∏ –∑–∞–ø—Ä–æ—Å–æ–≤/–æ—Ç–≤–µ—Ç–æ–≤
3. **–ú–µ—Ç—Ä–∏–∫–∏** - –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è tools, –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–≤–µ—Ç–∞
4. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** - –∫—ç—à –¥–ª—è —á–∞—Å—Ç–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã—Ö —Ç—É—Ä–æ–≤
5. **–ú—É–ª—å—Ç–∏—è–∑—ã—á–Ω–æ—Å—Ç—å** - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –¥—Ä—É–≥–∏—Ö —è–∑—ã–∫–æ–≤
6. **–í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å** - –≤–µ–±-UI –≤–º–µ—Å—Ç–æ CLI
7. **Streaming –æ—Ç–≤–µ—Ç–æ–≤** - –ø–æ—Ç–æ–∫–æ–≤–∞—è –ø–µ—Ä–µ–¥–∞—á–∞ –æ—Ç–≤–µ—Ç–æ–≤ –¥–ª—è UX

---

## üìö –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- **LangChain Agents**: https://python.langchain.com/docs/modules/agents/
- **OpenAI Tools**: https://platform.openai.com/docs/guides/function-calling
- **Backend API Docs**: http://localhost:8000/docs (–ø—Ä–∏ –∑–∞–ø—É—â–µ–Ω–Ω–æ–º –±—ç–∫–µ–Ω–¥–µ)

---

## üéØ –î–ª—è AI –∞–≥–µ–Ω—Ç–æ–≤: –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

–ï—Å–ª–∏ –≤–∞–º –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –∏–ª–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç—å —á–∞—Ç-–±–æ—Ç:

1. **–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π tool**:
   - –§—É–Ω–∫—Ü–∏—è –≤ `src/tools/backend_tools.py`
   - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ `src/tools/tool_registry.py`
   - –û–±–Ω–æ–≤–∏—Ç—å `SYSTEM_PROMPT` –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

2. **–ò–∑–º–µ–Ω–∏—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ –∞–≥–µ–Ω—Ç–∞**:
   - –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å `SYSTEM_PROMPT` –≤ `src/prompts/system_prompts.py`

3. **–ò–∑–º–µ–Ω–∏—Ç—å –ø–∞–º—è—Ç—å**:
   - –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å `ConversationMemory` –≤ `src/memory/conversation_memory.py`
   - –î–ª—è Redis: –∑–∞–º–µ–Ω–∏—Ç—å `ConversationBufferMemory` –Ω–∞ `ConversationBufferWindowMemory` —Å Redis backend

4. **–ò–∑–º–µ–Ω–∏—Ç—å LLM**:
   - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ `MainAgent.__init__()` –∏–ª–∏ —á–µ—Ä–µ–∑ .env

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: 2025-12-18  
**–í–µ—Ä—Å–∏—è**: 1.0  
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –†–∞–±–æ—á–∞—è –≤–µ—Ä—Å–∏—è, –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∞

